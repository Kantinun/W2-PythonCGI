<html>
<head>
    <meta charset="utf-8" />
    <title>Break out Game</title>
    <style>
    	* { padding: 0; margin: 0; }
    	canvas { background: #eee; display: block; margin: 0 auto; }
    </style>
</head>
<body>
<canvas id="myCanvas" width="480" height="320"></canvas>
<script>
    class Ball{
        constructor(tmpx, tmpy){
            this.x = tmpx;
            this.y = tmpy;
            this.speedX = 2;
            this.speedY = -2;
            this.Radius = 10;
        }
        draw(){
            document.getElementById("myCanvas").getContext("2d").beginPath();
            document.getElementById("myCanvas").getContext("2d").arc(this.x, this.y, this.Radius, 0, Math.PI*2);
            document.getElementById("myCanvas").getContext("2d").fillStyle = "#0095DD";
            document.getElementById("myCanvas").getContext("2d").fill();
            document.getElementById("myCanvas").getContext("2d").closePath();
            
        }
        move(){
            this.x += this.speedX;
            this.y += this.speedY;
        }
        bounceX(){
            this.speedX = -this.speedX;
        }
        bounceY(){
            this.speedY =-this.speedY;
        }
    }
    class Brick{
        constructor(){
            this.x;
            this.y;
            this.offsetY;
            this.offsetX;
            this.width;
            this.height;
            this.status;
        }
        draw(){}
    }
    class Paddle{
        constructor(){
            this.canvas = document.getElementById("myCanvas");
            this.ctx = this.canvas.getContext("2d");
            this.width = this.canvas.width;
            this.height = this.canvas.height;
            this.paddleHeight = 10;
            this.paddleWidth = 75;
            this.paddleX = (this.width-this.paddleWidth)/2;
            this.speedX = 7;
        }
        draw(){
            this.ctx.beginPath()
            this.ctx.rect(this.paddleX,this.height-this.paddleHeight,this.paddleWidth,this.paddleHeight)
            this.ctx.fillStyle = "#0095DD";
            this.ctx.fill();
            this.ctx.closePath();
        }
    }
    class InputProcessor{
        constructor(){
            this.keyLeft = false;
            this.keyRight = false;
            var _this = this;
            document.onkeydown = function(event){_this.pushDown(event.which)}
            document.onkeyup = function(event){_this.pushUp(event.which)}
            document.onmousemove = function(event){_this.pushUp(event.which)}
        }
        pushDown(key){
            if(key == 37){
                this.keyRight = true;
            }
            else if(key == 39){
                this.keyLeft = true;
            }
        }
        pushUp(key){
            if(key == 37){
                this.keyRight = false;
            }
            else if(key == 39){
                this.keyLeft = false;
            }
        }
        mouseMoveHandler(key){
            
        }
    }
    class World{
        constructor(ro,co){
            this.canvas = document.getElementById("myCanvas");
            this.ctx = this.canvas.getContext("2d");
            this.ball = new Ball(this.canvas.width/2,this.canvas.height/2);
            this.brick = [];
            this.paddle = new Paddle();
            this.brickRow = ro;
            this.brickColumn = co;
            this.inputProcessor = new InputProcessor();
            this.live; 
            var _this = this;
            this.interval = setInterval(function () { _this.update(); },10);   
        }
        update(){
            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
            this.ball.draw();
            this.ball.move();
            this.paddle.draw();
            if(this.ball.x + this.ball.speedX > this.canvas.width-this.ball.Radius || this.ball.x + this.ball.speedX  < this.ball.Radius) {
                this.ball.bounceX();
            }
            if(this.ball.y + this.ball.speedY < this.ball.Radius) {
                this.ball.bounceY();
            }else if(this.ball.y + this.ball.speedY > this.canvas.height-this.ball.Radius){
                if( this.ball.x > this.paddle.paddleX && this.ball.x < this.paddle.paddleX + this.paddle.paddleWidth){
                    this.ball.bounceY();
                }else{
                    alert("GAME OVER");
                    document.location.reload();
                    clearInterval(this.interval); // Needed for Chrome to end game
                }
                
            }
            if(this.inputProcessor.keyLeft && this.paddle.paddleX < this.canvas.width-this.paddle.paddleWidth) {
                this.paddle.paddleX += 7;
            }
            else if(this.inputProcessor.keyRight && this.paddle.paddleX > 0) {
                this.paddle.paddleX -= 7;
            }
        }
        collisionDetection(){}
    }

var w = new World(2,2);
function run() {
    w.update();
}

</script>
</body>
</html>